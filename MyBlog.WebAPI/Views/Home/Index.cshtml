@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}


@model HomeViewModel


<body>
    <div class="layui-layout layui-layout-admin">
        <div class="layui-header layui-bg-green">





@* LOSER の BLOG *@
            <div class=" layui-logo layui-hide-xs layui-bg-green " style="font-size:20px;font-weight:bold">MyBlog</div>
            <ul class="layui-nav layui-layout-left">

                <li class="layui-nav-item layui-hide-xs"><a href="">nav 1</a></li>
                <li class="layui-nav-item layui-hide-xs"><a href="">nav 2</a></li>
                <li class="layui-nav-item layui-hide-xs"><a href="">nav 3</a></li>
                <li class="layui-nav-item">
                    <a href="javascript:;">nav groups</a>
                    <dl class="layui-nav-child">
                        <dd><a href="">menu 11</a></dd>
                        <dd><a href="">menu 22</a></dd>
                        <dd><a href="">menu 33</a></dd>
                    </dl>
                </li>
            </ul>



            <ul class="layui-nav layui-layout-right">

                

                


                <li id="login_register" class="layui-nav-item layui-hide layui-show-md-inline-block" style="margin-right:40px;display:none">
                    
                    <div >
                        
                        <div type="button" onclick="login_register_click()">
                            登录 / 注册   
                        </div>
                    </div>
                </li>



                <li id="usermodule" class="layui-nav-item"  lay-unselect="" style="display:none;">
                        <a href="javascript:;">
                            <img id="head_img" src="" tppabs="http://t.cn/RCzsdCq" class="layui-nav-img">
                        </a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;">子级菜单</a></dd>
                            <dd><a href="javascript:;">横线隔断</a></dd>
                            <hr>
                            <dd style="text-align: center;" onclick="exit_login()"><a href="">退出</a></dd>
                        </dl>
                </li>




                <li class="layui-nav-item" lay-header-event="menuRight" lay-unselect>
                    <a href="javascript:;">
                        <i class="layui-icon layui-icon-more-vertical"></i>
                    </a>
                </li>
            </ul>
        </div>


    </div>



    <div id="main_body">

        <div style="padding: 20px;">顶上填充的东西，千万别露馅了，你看不到_(:з」∠)_</div>
        <div id="main_page" class="main_page" >
            

            @* <img title="default" src="photos/default_homepage.jpeg" /> *@

            <h1 id="motto" class="motto_class"> </h1>



            <br>
            <br>
            
            <br>
            <br>
            
            <br>
            <br>

            <button type="button" onclick="window.location.href='Blog/BlogPage'" class="layui-btn layui-btn-lg layui-btn-radius">进入博客</button>

        
            
        </div>
        <div style="padding: 20px;">内容主体区域。记得修改 layui.css 和 js 的路径</div>
    </div>


    @section Scripts{ 
    <script>
        //JS
        layui.use(['element', 'layer', 'util'], function () {
            var element = layui.element
                , layer = layui.layer
                , util = layui.util
                , $ = layui.$;

            //头部事件
            util.event('lay-header-event', {
                //左侧菜单事件
                menuLeft: function (othis) {
                    layer.msg('展开左侧菜单的操作', { icon: 0 });
                }
                , menuRight: function () {
                    layer.open({
                        type: 1
                        , content: '<div style="padding: 15px;">处理右侧面板的操作</div>'
                        , area: ['260px', '100%']
                        , offset: 'rt' //右上角
                        , anim: 5
                        , shadeClose: true
                    });
                }
            });

        });



        function login_register_click() {
            layer.open({
                type: 2,
                title: '登录/注册' ,
                area: ['450px', '500px'],
                fixed: false, //不固定
                maxmin: true,
                content: '/Home/Login'
            });


        }


        function getCookie(name) {
            var str = document.cookie;
            var arr = str.split("; ");
            for (var i = 0; i < arr.length; i++) {
                var arr1 = arr[i].split("=");
                if (arr1[0] == name) {
                    return arr1[1];
                }
            }
            return null;
        }



        document.ready = function () {

            var is_login = getCookie("is_login");

            if (is_login == "true") {


                $.ajax({
                    url: "/api/UserInfo/GetUserInfo",
                    type: 'GET',
                    headers: {
                        'Authorization': localStorage.getItem("JWTtoken")
                    },
                    success: function (res) {
                        $('body').append("<style>.main_page:after{background:none}</style>");
                        var url_txt = res.data.mainPagePhoto.url;

                        var url = url_txt.toString();
                        $('body').append("<style>.main_page:after{background:" + "url(" + url + ") no-repeat;background-size: cover;content: '';position: absolute;top: 0;left: 0;right:0;z-index: -1;opacity: 0.5;" + "}</style>");

                        $("#motto").text(res.data.motto);
                        $("#login_register").remove();
                        $("#usermodule").css("display", "inline-block");

                        $("#head_img").attr("src", url);
                    },
                    error: function (res) {
                        alert("获取用户数据失败！");
                    }




                });
            } else {
                $("#motto").text("@Model?.motto");

                $("#login_register").css("display", "inline-block");

            }
        }



        function exit_login(){
            document.cookie = "is_login" + "=" + "false" +"; expires=Thu, 18 Dec 2043 12:00:00 GMT; path=/";
            localStorage.remove("JWTtoken");
            window.location.href='Home/Index';
            
            
        }










    </script>
    }




    <div class="layui-footer footer text-muted">
        &copy; 2022 - MyBlog.WebAPI - <a asp-area="" asp-page="/Privacy">MyBlog</a>
    </div>



    <style>


        .main_page{
            display:flex;
            flex-direction:column;
            justify-content:center;
            align-items:center;

            height: 100vh;





        }

        .main_page:after {
 
                background:url(@Model?.photo.FilePath) no-repeat;
                background-size: cover;
                content: "";
                position: absolute;
                top: 0;
                left: 0;
                right:0;
                bottom:0;
                z-index: -1;/*-1 可以当背景*/
/*                -webkit-filter: blur(3px);
                filter: blur(3px);*/
                 opacity: 0.7;

        }

        .motto_class{
            display:flex;
            flex-direction:column;
            justify-content:center;
            align-items:center;
            opacity: 1;
            color: black;
            font-size: 70px;
            font-weight:bold;
        }


   
                   







    </style>

</body>
